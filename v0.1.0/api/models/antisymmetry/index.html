
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.0.5">
    
    
      
        <title>antisymmetry - vmcnet</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.a617204b.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.9204c3b2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/docstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/sidebar.css">
    
      <link rel="stylesheet" href="../../../stylesheets/content.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#vmcnet.models.antisymmetry" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
        </aside>
      </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="vmcnet" class="md-header__button md-logo" aria-label="vmcnet" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            vmcnet
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              antisymmetry
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/jeffminlin/vmcnet" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jeffminlin/vmcnet
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../examples/harmonic_oscillator/" class="md-tabs__link md-tabs__link--active">
        API Reference
      </a>
    </li>
  

  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../CONTRIBUTING/" class="md-tabs__link">
      Contributing
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="vmcnet" class="md-nav__button md-logo" aria-label="vmcnet" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    vmcnet
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/jeffminlin/vmcnet" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jeffminlin/vmcnet
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_1">
          examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="examples" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/harmonic_oscillator/" class="md-nav__link">
        harmonic_oscillator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/hydrogen_like_atom/" class="md-nav__link">
        hydrogen_like_atom
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_2">
          mcmc
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="mcmc" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          mcmc
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mcmc/dynamic_width_position_amplitude/" class="md-nav__link">
        dynamic_width_position_amplitude
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mcmc/metropolis/" class="md-nav__link">
        metropolis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mcmc/position_amplitude_core/" class="md-nav__link">
        position_amplitude_core
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mcmc/simple_position_amplitude/" class="md-nav__link">
        simple_position_amplitude
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mcmc/statistics/" class="md-nav__link">
        statistics
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2_3">
          models
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="models" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          models
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../antiequivariance/" class="md-nav__link">
        antiequivariance
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          antisymmetry
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        antisymmetry
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#vmcnet.models.antisymmetry" class="md-nav__link">
    vmcnet.models.antisymmetry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vmcnet.models.antisymmetry.FactorizedAntisymmetrize" class="md-nav__link">
    FactorizedAntisymmetrize
  </a>
  
    <nav class="md-nav" aria-label="FactorizedAntisymmetrize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vmcnet.models.antisymmetry.FactorizedAntisymmetrize.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vmcnet.models.antisymmetry.GenericAntisymmetrize" class="md-nav__link">
    GenericAntisymmetrize
  </a>
  
    <nav class="md-nav" aria-label="GenericAntisymmetrize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vmcnet.models.antisymmetry.GenericAntisymmetrize.setup" class="md-nav__link">
    setup()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vmcnet.models.antisymmetry.GenericAntisymmetrize.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vmcnet.models.antisymmetry.ParallelPermutations" class="md-nav__link">
    ParallelPermutations
  </a>
  
    <nav class="md-nav" aria-label="ParallelPermutations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vmcnet.models.antisymmetry.ParallelPermutations.setup" class="md-nav__link">
    setup()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vmcnet.models.antisymmetry.ParallelPermutations.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vmcnet.models.antisymmetry.slogdet_product" class="md-nav__link">
    slogdet_product()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vmcnet.models.antisymmetry.logdet_product" class="md-nav__link">
    logdet_product()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../construct/" class="md-nav__link">
        construct
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/" class="md-nav__link">
        core
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../equivariance/" class="md-nav__link">
        equivariance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jastrow/" class="md-nav__link">
        jastrow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sign_symmetry/" class="md-nav__link">
        sign_symmetry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../weights/" class="md-nav__link">
        weights
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4" type="checkbox" id="__nav_2_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_4">
          physics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="physics" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          physics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../physics/core/" class="md-nav__link">
        core
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../physics/kinetic/" class="md-nav__link">
        kinetic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../physics/potential/" class="md-nav__link">
        potential
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_5" type="checkbox" id="__nav_2_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_5">
          train
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="train" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_5">
          <span class="md-nav__icon md-icon"></span>
          train
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../train/default_config/" class="md-nav__link">
        default_config
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../train/parse_config_flags/" class="md-nav__link">
        parse_config_flags
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../train/runners/" class="md-nav__link">
        runners
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../train/vmc/" class="md-nav__link">
        vmc
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_6" type="checkbox" id="__nav_2_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_6">
          updates
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="updates" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_6">
          <span class="md-nav__icon md-icon"></span>
          updates
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../updates/params/" class="md-nav__link">
        params
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../updates/parse_config/" class="md-nav__link">
        parse_config
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../updates/sr/" class="md-nav__link">
        sr
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_7" type="checkbox" id="__nav_2_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_7">
          utils
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="utils" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_7">
          <span class="md-nav__icon md-icon"></span>
          utils
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/checkpoint/" class="md-nav__link">
        checkpoint
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/distribute/" class="md-nav__link">
        distribute
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/kfac/" class="md-nav__link">
        kfac
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/log_linear_exp/" class="md-nav__link">
        log_linear_exp
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/pytree_helpers/" class="md-nav__link">
        pytree_helpers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/slog_helpers/" class="md-nav__link">
        slog_helpers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../CONTRIBUTING/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#vmcnet.models.antisymmetry" class="md-nav__link">
    vmcnet.models.antisymmetry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vmcnet.models.antisymmetry.FactorizedAntisymmetrize" class="md-nav__link">
    FactorizedAntisymmetrize
  </a>
  
    <nav class="md-nav" aria-label="FactorizedAntisymmetrize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vmcnet.models.antisymmetry.FactorizedAntisymmetrize.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vmcnet.models.antisymmetry.GenericAntisymmetrize" class="md-nav__link">
    GenericAntisymmetrize
  </a>
  
    <nav class="md-nav" aria-label="GenericAntisymmetrize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vmcnet.models.antisymmetry.GenericAntisymmetrize.setup" class="md-nav__link">
    setup()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vmcnet.models.antisymmetry.GenericAntisymmetrize.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vmcnet.models.antisymmetry.ParallelPermutations" class="md-nav__link">
    ParallelPermutations
  </a>
  
    <nav class="md-nav" aria-label="ParallelPermutations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vmcnet.models.antisymmetry.ParallelPermutations.setup" class="md-nav__link">
    setup()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vmcnet.models.antisymmetry.ParallelPermutations.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vmcnet.models.antisymmetry.slogdet_product" class="md-nav__link">
    slogdet_product()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vmcnet.models.antisymmetry.logdet_product" class="md-nav__link">
    logdet_product()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

  <h1>antisymmetry</h1>

<div class="doc doc-object doc-module">

<a id="vmcnet.models.antisymmetry"></a>
    <div class="doc doc-contents first">

      <p>Antisymmetry parts to compose into a model.</p>



  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h3 id="vmcnet.models.antisymmetry.FactorizedAntisymmetrize" class="doc doc-heading">
        <code>
FactorizedAntisymmetrize            (<span title="vmcnet.models.core.Module">Module</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Separately antisymmetrize fns over leaves of a pytree and return the product.</p>
<p>See https://arxiv.org/abs/2112.03491 for a description of the factorized
antisymmetric layer.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>fns_to_antisymmetrize</code></td>
        <td><code>pytree</code></td>
        <td><p>pytree of functions with the same tree structure
as the input pytree, each of which is a Callable with signature
Array of shape (..., ninput_dim) -&gt; Array of shape (..., dout).
On the ith leaf, ninput_dim = n[i] * din[i], where n[i] is the size of the
second-to-last axis and din[i] is the size of the last axis of the input xs.</p></td>
      </tr>
      <tr>
        <td><code>logabs</code></td>
        <td><code>bool</code></td>
        <td><p>whether to compute sum_i log(abs(psi_i)) if logabs is
True, or prod_i psi_i if logabs is False, where psi_i is the output from
antisymmetrizing the ith function on the ith input. Defaults to True.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">














  <div class="doc doc-object doc-method">



<h4 id="vmcnet.models.antisymmetry.FactorizedAntisymmetrize.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h4>

    <div class="doc doc-contents ">

      <p>Antisymmetrize the leaves of self.fns_to_antisymmetrize on the leaves of xs.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>xs</code></td>
        <td><code>pytree</code></td>
        <td><p>pytree of inputs with the same tree structure as that of
self.fns_to_antisymmetrize. The ith leaf has shape (..., n[i], d[i]),
and the ith antisymmetrization happens with respect to n[i].</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Array or SLArray</code></td>
      <td><p>prod_i psi_i if self.logabs is False, or
    prod_i sign(psi_i), sum_i log(abs(psi_i)) if self.logabs is True,
where psi_i is the output from antisymmetrizing the ith function on the ith
input.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>vmcnet/models/antisymmetry.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@flax</span><span class="o">.</span><span class="n">linen</span><span class="o">.</span><span class="n">compact</span>
<span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xs</span><span class="p">:</span> <span class="n">PyTree</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Array</span><span class="p">,</span> <span class="n">SLArray</span><span class="p">]:</span>  <span class="c1"># type: ignore[override]</span>
    <span class="sd">&quot;&quot;&quot;Antisymmetrize the leaves of self.fns_to_antisymmetrize on the leaves of xs.</span>

<span class="sd">    Args:</span>
<span class="sd">        xs (pytree): pytree of inputs with the same tree structure as that of</span>
<span class="sd">            self.fns_to_antisymmetrize. The ith leaf has shape (..., n[i], d[i]),</span>
<span class="sd">            and the ith antisymmetrization happens with respect to n[i].</span>

<span class="sd">    Returns:</span>
<span class="sd">        Array or SLArray:</span>
<span class="sd">            prod_i psi_i if self.logabs is False, or</span>
<span class="sd">            prod_i sign(psi_i), sum_i log(abs(psi_i)) if self.logabs is True,</span>
<span class="sd">        where psi_i is the output from antisymmetrizing the ith function on the ith</span>
<span class="sd">        input.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Flatten the trees for fns_to_antisymmetrize and xs, because Module</span>
    <span class="c1"># freezes all instances of lists to tuples, so this can cause treedef</span>
    <span class="c1"># compatibility problems</span>
    <span class="n">antisyms</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree_map</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_single_leaf_call</span><span class="p">,</span>
        <span class="n">jax</span><span class="o">.</span><span class="n">tree_leaves</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fns_to_antisymmetrize</span><span class="p">),</span>
        <span class="n">jax</span><span class="o">.</span><span class="n">tree_leaves</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">logabs</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_reduce_prod_over_leaves</span><span class="p">(</span><span class="n">antisyms</span><span class="p">)</span>

    <span class="n">slog_antisyms</span> <span class="o">=</span> <span class="n">array_list_to_slog</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">tree_leaves</span><span class="p">(</span><span class="n">antisyms</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">slog_multiply</span><span class="p">,</span> <span class="n">slog_antisyms</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="vmcnet.models.antisymmetry.GenericAntisymmetrize" class="doc doc-heading">
        <code>
GenericAntisymmetrize            (<span title="vmcnet.models.core.Module">Module</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Antisymmetrize a single function over the leaves of a pytree.</p>
<p>See https://arxiv.org/abs/2112.03491 for a description of the generic antisymmetric
layer.</p>
<p>For each leaf of a pytree, a given function of all the leaves is antisymmetrized
over the second-to-last axis of each leaf. These explicit antisymmetrization
operations are composed with each other (they commute, so the order does not
matter), giving an output which is antisymmetric with respect to particle exchange
within each leaf but not with respect to particle exchange between leaves.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>fn_to_antisymmetrize</code></td>
        <td><code>Callable</code></td>
        <td><p>Callable with signature
Array with shape (..., ninput_dim) -&gt; (..., 1). This is the function
to be antisymmetrized. ninput_dim is equal to
    n[1] * d[1] + ... + n[k] * d[k],
where n[i] is the size of the second-to-last axis and d[i] is the size of
the last axis of the ith leaf of the input xs.</p></td>
      </tr>
      <tr>
        <td><code>logabs</code></td>
        <td><code>bool</code></td>
        <td><p>whether to compute log(abs(psi)) if logabs is True, or
psi if logabs is False, where psi is the output from antisymmetrizing
self.fn_to_antisymmetrize. Defaults to True.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">














  <div class="doc doc-object doc-method">



<h4 id="vmcnet.models.antisymmetry.GenericAntisymmetrize.setup" class="doc doc-heading">
<code class="highlight language-python"><span class="n">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Setup the function to antisymmetrize.</p>

        <details class="quote">
          <summary>Source code in <code>vmcnet/models/antisymmetry.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Setup the function to antisymmetrize.&quot;&quot;&quot;</span>
    <span class="c1"># workaround MyPy&#39;s typing error for callable attribute, see</span>
    <span class="c1"># https://github.com/python/mypy/issues/708</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_fn_to_antisymmetrize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fn_to_antisymmetrize</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="vmcnet.models.antisymmetry.GenericAntisymmetrize.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h4>

    <div class="doc doc-contents ">

      <p>Antisymmetrize self.fn_to_antisymmetrize over the leaves of xs.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>xs</code></td>
        <td><code>pytree</code></td>
        <td><p>a pytree of inputs, each which corresponds to a different set
of particles to antisymmetrize with respect to. The ith leaf has shape
(..., n[i], d[i]), and the antisymmetrization happens with respect to
n[i].</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Array</code></td>
      <td><p>psi if logabs is False, or
    sign(psi), log(abs(psi)) if self.logabs is True,
where psi is the output from antisymmetrizing
self.fn_to_antisymmetrize on all leaves of xs.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>vmcnet/models/antisymmetry.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@flax</span><span class="o">.</span><span class="n">linen</span><span class="o">.</span><span class="n">compact</span>
<span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xs</span><span class="p">:</span> <span class="n">PyTree</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Array</span><span class="p">,</span> <span class="n">SLArray</span><span class="p">]:</span>  <span class="c1"># type: ignore[override]</span>
    <span class="sd">&quot;&quot;&quot;Antisymmetrize self.fn_to_antisymmetrize over the leaves of xs.</span>

<span class="sd">    Args:</span>
<span class="sd">        xs (pytree): a pytree of inputs, each which corresponds to a different set</span>
<span class="sd">            of particles to antisymmetrize with respect to. The ith leaf has shape</span>
<span class="sd">            (..., n[i], d[i]), and the antisymmetrization happens with respect to</span>
<span class="sd">            n[i].</span>

<span class="sd">    Returns:</span>
<span class="sd">        Array:</span>
<span class="sd">            psi if logabs is False, or</span>
<span class="sd">            sign(psi), log(abs(psi)) if self.logabs is True,</span>
<span class="sd">        where psi is the output from antisymmetrizing</span>
<span class="sd">        self.fn_to_antisymmetrize on all leaves of xs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">perms_and_signs</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree_map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_single_leaf_perm</span><span class="p">,</span> <span class="n">xs</span><span class="p">)</span>
    <span class="n">perms_and_signs_leaves</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree_flatten</span><span class="p">(</span>
        <span class="n">perms_and_signs</span><span class="p">,</span> <span class="n">is_tuple_of_arrays</span>
    <span class="p">)</span>
    <span class="n">nleaves</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">perms_and_signs_leaves</span><span class="p">)</span>
    <span class="n">nperms_per_leaf</span> <span class="o">=</span> <span class="p">[</span><span class="n">leaf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">perms_and_signs_leaves</span><span class="p">]</span>

    <span class="n">broadcasted_perms</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">reshaped_signs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">leaf_perms</span><span class="p">,</span> <span class="n">leaf_signs</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">perms_and_signs_leaves</span><span class="p">):</span>
        <span class="n">ith_factorial</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="n">leaf_signs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span> <span class="o">*</span> <span class="p">(</span><span class="n">nleaves</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># desired sign[i] shape is (1, ..., n_i!, ..., 1, 1), with nspins + 1 dims</span>
        <span class="n">sign_shape</span> <span class="o">=</span> <span class="n">ith_factorial</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span>
        <span class="n">leaf_signs</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">leaf_signs</span><span class="p">,</span> <span class="n">sign_shape</span><span class="p">)</span>
        <span class="n">reshaped_signs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leaf_signs</span><span class="p">)</span>

        <span class="c1"># desired broadcasted x_i shape is [i: (..., n_1!, ..., n_k!, n_i * d_i)],</span>
        <span class="c1"># where k = nleaves, and x_i = (..., n_i, d_i). This is achieved by:</span>
        <span class="c1"># 1) reshape to (..., 1, ..., n_i!,... 1, n_i, d_i), then</span>
        <span class="c1"># 2) broadcast to (..., n_1!, ..., n_k!, n_i, d_i)</span>
        <span class="c1"># 3) flatten last axis to (..., n_1!, ..., n_k!, n_i * d_i)</span>
        <span class="n">reshape_x_shape</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">leaf_perms</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">ith_factorial</span> <span class="o">+</span> <span class="n">leaf_perms</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
        <span class="p">)</span>
        <span class="n">broadcast_x_shape</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">leaf_perms</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">nperms_per_leaf</span><span class="p">)</span> <span class="o">+</span> <span class="n">leaf_perms</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
        <span class="p">)</span>
        <span class="n">leaf_perms</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">leaf_perms</span><span class="p">,</span> <span class="n">reshape_x_shape</span><span class="p">)</span>
        <span class="n">leaf_perms</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">leaf_perms</span><span class="p">,</span> <span class="n">broadcast_x_shape</span><span class="p">)</span>
        <span class="n">flat_leaf_perms</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">leaf_perms</span><span class="p">,</span> <span class="n">leaf_perms</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,))</span>
        <span class="n">broadcasted_perms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flat_leaf_perms</span><span class="p">)</span>

    <span class="c1"># make input shape (..., n_1!, ..., n_k!, n_1 * d_1 + ... + n_k * d_k)</span>
    <span class="n">concat_perms</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">broadcasted_perms</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">all_perms_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fn_to_antisymmetrize</span><span class="p">(</span><span class="n">concat_perms</span><span class="p">)</span>

    <span class="c1"># all_perms_out has shape (..., n_1!, ..., n_k!, 1)</span>
    <span class="c1"># Each leaf of reshaped_signs has k+1 axes, but all except the ith axis has size</span>
    <span class="c1"># 1. The ith axis has size n_i!. Thus when the leaves of reshaped_signs are</span>
    <span class="c1"># multiplied with all_perms_out, the product will broadcast each leaf and apply</span>
    <span class="c1"># the signs along the correct (ith) axis of the output.</span>
    <span class="n">signed_perms_out</span> <span class="o">=</span> <span class="n">_reduce_prod_over_leaves</span><span class="p">([</span><span class="n">all_perms_out</span><span class="p">,</span> <span class="n">reshaped_signs</span><span class="p">])</span>

    <span class="n">antisymmetrized_out</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
        <span class="n">signed_perms_out</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="o">-</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nleaves</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">logabs</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">antisymmetrized_out</span>

    <span class="k">return</span> <span class="n">array_to_slog</span><span class="p">(</span><span class="n">antisymmetrized_out</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="vmcnet.models.antisymmetry.ParallelPermutations" class="doc doc-heading">
        <code>
ParallelPermutations            (<span title="vmcnet.models.core.Module">Module</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Get all perms along the 2nd-to-last axis, w/ perms stored as a constant.</p>
<p>If inputs are shape (..., n, d), then the outputs are shape (..., n!, n, d).
The signs of the permutations are also returned. This layer is here so that the
permutations and their signs are stored as a constant in the computational graph,
instead of being recomputed at each iteration. This makes sense to do if there is
enough memory to store all permutations of the input and any downstream
computations, so that downstream computations can be done in parallel on all
permutations. If there is not enough memory for this, then it is better to compute
the permutations on the fly.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>n</code></td>
        <td><code>int</code></td>
        <td><p>size of the second-to-last axis of the inputs. Should be &gt;= 1.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">













  <div class="doc doc-object doc-method">



<h4 id="vmcnet.models.antisymmetry.ParallelPermutations.setup" class="doc doc-heading">
<code class="highlight language-python"><span class="n">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Store the list of permutations and signs for the symmetric group.</p>

        <details class="quote">
          <summary>Source code in <code>vmcnet/models/antisymmetry.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Store the list of permutations and signs for the symmetric group.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">permutation_list</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">permutations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">))))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">signs</span> <span class="o">=</span> <span class="n">_get_lexicographic_signs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="vmcnet.models.antisymmetry.ParallelPermutations.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h4>

    <div class="doc doc-contents ">

      <p>Collect all permutations of x and the signs of these permutations.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td><code>Array</code></td>
        <td><p>an array of particles with shape (..., n, d)</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>(Array, Array)</code></td>
      <td><p>all permutations of x along the second axis,
with shape (..., n!, n, d), and the signs of the permutations in the same
order as the third-to-last axis (lexicographic order)</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>vmcnet/models/antisymmetry.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Array</span><span class="p">,</span> <span class="n">Array</span><span class="p">]:</span>  <span class="c1"># type: ignore[override]</span>
    <span class="sd">&quot;&quot;&quot;Collect all permutations of x and the signs of these permutations.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (Array): an array of particles with shape (..., n, d)</span>

<span class="sd">    Returns:</span>
<span class="sd">        (Array, Array): all permutations of x along the second axis,</span>
<span class="sd">        with shape (..., n!, n, d), and the signs of the permutations in the same</span>
<span class="sd">        order as the third-to-last axis (lexicographic order)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">permutation_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">signs</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h3 id="vmcnet.models.antisymmetry.slogdet_product" class="doc doc-heading">
<code class="highlight language-python"><span class="n">slogdet_product</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Compute the (sign, log) of the product of determinants of the leaves of a pytree.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>xs</code></td>
        <td><code>pytree</code></td>
        <td><p>pytree of tensors which are square in the last two dimensions, i.e.
all leaves must have shape (..., n_leaf, n_leaf); the last two dims can
be different from leaf to leaf, but the batch dimensions must be the same
for all leaves.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>(Array, Array)</code></td>
      <td><p>the product of the sign_dets and the sum of the
log_dets over all leaves of the pytree xs</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>vmcnet/models/antisymmetry.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">slogdet_product</span><span class="p">(</span><span class="n">xs</span><span class="p">:</span> <span class="n">PyTree</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SLArray</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Compute the (sign, log) of the product of determinants of the leaves of a pytree.</span>

<span class="sd">    Args:</span>
<span class="sd">        xs (pytree): pytree of tensors which are square in the last two dimensions, i.e.</span>
<span class="sd">            all leaves must have shape (..., n_leaf, n_leaf); the last two dims can</span>
<span class="sd">            be different from leaf to leaf, but the batch dimensions must be the same</span>
<span class="sd">            for all leaves.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (Array, Array): the product of the sign_dets and the sum of the</span>
<span class="sd">        log_dets over all leaves of the pytree xs</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">slogdets</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree_map</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">slogdet</span><span class="p">,</span> <span class="n">xs</span><span class="p">)</span>

    <span class="n">slogdet_leaves</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree_flatten</span><span class="p">(</span><span class="n">slogdets</span><span class="p">,</span> <span class="n">is_tuple_of_arrays</span><span class="p">)</span>
    <span class="n">sign_prod</span><span class="p">,</span> <span class="n">log_prod</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">slogdet_leaves</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">sign_prod</span><span class="p">,</span> <span class="n">log_prod</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="vmcnet.models.antisymmetry.logdet_product" class="doc doc-heading">
<code class="highlight language-python"><span class="n">logdet_product</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Compute the log|prod_x det(x)| of the leaves x of a pytree (throwing away sign).</p>
<p>Because we don't need to carry sign, the logic can be made slightly simpler and
we can avoid a few computations.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>xs</code></td>
        <td><code>pytree</code></td>
        <td><p>pytree of tensors which are square in the last two dimensions, i.e.
all leaves must have shape (..., n_leaf, n_leaf); the last two dims can
be different from leaf to leaf, but the batch dimensions must be the same
for all leaves.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Array</code></td>
      <td><p>the sum of the log_dets over all leaves of the pytree xs, which is
equal to the log of the product of the dets over all leaves of xs</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>vmcnet/models/antisymmetry.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">logdet_product</span><span class="p">(</span><span class="n">xs</span><span class="p">:</span> <span class="n">PyTree</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Compute the log|prod_x det(x)| of the leaves x of a pytree (throwing away sign).</span>

<span class="sd">    Because we don&#39;t need to carry sign, the logic can be made slightly simpler and</span>
<span class="sd">    we can avoid a few computations.</span>

<span class="sd">    Args:</span>
<span class="sd">        xs (pytree): pytree of tensors which are square in the last two dimensions, i.e.</span>
<span class="sd">            all leaves must have shape (..., n_leaf, n_leaf); the last two dims can</span>
<span class="sd">            be different from leaf to leaf, but the batch dimensions must be the same</span>
<span class="sd">            for all leaves.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Array: the sum of the log_dets over all leaves of the pytree xs, which is</span>
<span class="sd">        equal to the log of the product of the dets over all leaves of xs</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logdets</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree_map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">slogdet</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">xs</span><span class="p">)</span>
    <span class="n">log_prod</span> <span class="o">=</span> <span class="n">_reduce_sum_over_leaves</span><span class="p">(</span><span class="n">logdets</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">log_prod</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../antiequivariance/" class="md-footer__link md-footer__link--prev" aria-label="Previous: antiequivariance" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              antiequivariance
            </div>
          </div>
        </a>
      
      
        
        <a href="../construct/" class="md-footer__link md-footer__link--next" aria-label="Next: construct" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              construct
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.tracking"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.cefbb252.min.js", "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.a5f8ea78.min.js"></script>
      
    
  </body>
</html>