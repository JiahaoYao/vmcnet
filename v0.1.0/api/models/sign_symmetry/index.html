
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.0.5">
    
    
      
        <title>sign_symmetry - vmcnet</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.a617204b.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.9204c3b2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/docstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/sidebar.css">
    
      <link rel="stylesheet" href="../../../stylesheets/content.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#vmcnet.models.sign_symmetry" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
        </aside>
      </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="vmcnet" class="md-header__button md-logo" aria-label="vmcnet" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            vmcnet
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              sign_symmetry
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/jeffminlin/vmcnet" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jeffminlin/vmcnet
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../examples/harmonic_oscillator/" class="md-tabs__link md-tabs__link--active">
        API Reference
      </a>
    </li>
  

  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../CONTRIBUTING/" class="md-tabs__link">
      Contributing
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="vmcnet" class="md-nav__button md-logo" aria-label="vmcnet" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    vmcnet
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/jeffminlin/vmcnet" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jeffminlin/vmcnet
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_1">
          examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="examples" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/harmonic_oscillator/" class="md-nav__link">
        harmonic_oscillator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/hydrogen_like_atom/" class="md-nav__link">
        hydrogen_like_atom
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_2">
          mcmc
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="mcmc" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          mcmc
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mcmc/dynamic_width_position_amplitude/" class="md-nav__link">
        dynamic_width_position_amplitude
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mcmc/metropolis/" class="md-nav__link">
        metropolis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mcmc/position_amplitude_core/" class="md-nav__link">
        position_amplitude_core
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mcmc/simple_position_amplitude/" class="md-nav__link">
        simple_position_amplitude
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mcmc/statistics/" class="md-nav__link">
        statistics
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2_3">
          models
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="models" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          models
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../antiequivariance/" class="md-nav__link">
        antiequivariance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../antisymmetry/" class="md-nav__link">
        antisymmetry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../construct/" class="md-nav__link">
        construct
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/" class="md-nav__link">
        core
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../equivariance/" class="md-nav__link">
        equivariance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jastrow/" class="md-nav__link">
        jastrow
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          sign_symmetry
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        sign_symmetry
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#vmcnet.models.sign_symmetry" class="md-nav__link">
    vmcnet.models.sign_symmetry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vmcnet.models.sign_symmetry.ProductsSignCovariance" class="md-nav__link">
    ProductsSignCovariance
  </a>
  
    <nav class="md-nav" aria-label="ProductsSignCovariance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vmcnet.models.sign_symmetry.ProductsSignCovariance.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vmcnet.models.sign_symmetry.apply_sign_symmetry_to_fn" class="md-nav__link">
    apply_sign_symmetry_to_fn()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vmcnet.models.sign_symmetry.make_sl_array_list_fn_sign_covariant" class="md-nav__link">
    make_sl_array_list_fn_sign_covariant()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vmcnet.models.sign_symmetry.make_array_list_fn_sign_covariant" class="md-nav__link">
    make_array_list_fn_sign_covariant()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vmcnet.models.sign_symmetry.make_array_list_fn_sign_invariant" class="md-nav__link">
    make_array_list_fn_sign_invariant()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../weights/" class="md-nav__link">
        weights
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4" type="checkbox" id="__nav_2_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_4">
          physics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="physics" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          physics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../physics/core/" class="md-nav__link">
        core
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../physics/kinetic/" class="md-nav__link">
        kinetic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../physics/potential/" class="md-nav__link">
        potential
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_5" type="checkbox" id="__nav_2_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_5">
          train
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="train" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_5">
          <span class="md-nav__icon md-icon"></span>
          train
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../train/default_config/" class="md-nav__link">
        default_config
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../train/parse_config_flags/" class="md-nav__link">
        parse_config_flags
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../train/runners/" class="md-nav__link">
        runners
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../train/vmc/" class="md-nav__link">
        vmc
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_6" type="checkbox" id="__nav_2_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_6">
          updates
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="updates" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_6">
          <span class="md-nav__icon md-icon"></span>
          updates
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../updates/params/" class="md-nav__link">
        params
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../updates/parse_config/" class="md-nav__link">
        parse_config
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../updates/sr/" class="md-nav__link">
        sr
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_7" type="checkbox" id="__nav_2_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_7">
          utils
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="utils" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_7">
          <span class="md-nav__icon md-icon"></span>
          utils
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/checkpoint/" class="md-nav__link">
        checkpoint
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/distribute/" class="md-nav__link">
        distribute
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/kfac/" class="md-nav__link">
        kfac
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/log_linear_exp/" class="md-nav__link">
        log_linear_exp
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/pytree_helpers/" class="md-nav__link">
        pytree_helpers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/slog_helpers/" class="md-nav__link">
        slog_helpers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../CONTRIBUTING/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#vmcnet.models.sign_symmetry" class="md-nav__link">
    vmcnet.models.sign_symmetry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vmcnet.models.sign_symmetry.ProductsSignCovariance" class="md-nav__link">
    ProductsSignCovariance
  </a>
  
    <nav class="md-nav" aria-label="ProductsSignCovariance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vmcnet.models.sign_symmetry.ProductsSignCovariance.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vmcnet.models.sign_symmetry.apply_sign_symmetry_to_fn" class="md-nav__link">
    apply_sign_symmetry_to_fn()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vmcnet.models.sign_symmetry.make_sl_array_list_fn_sign_covariant" class="md-nav__link">
    make_sl_array_list_fn_sign_covariant()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vmcnet.models.sign_symmetry.make_array_list_fn_sign_covariant" class="md-nav__link">
    make_array_list_fn_sign_covariant()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vmcnet.models.sign_symmetry.make_array_list_fn_sign_invariant" class="md-nav__link">
    make_array_list_fn_sign_invariant()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

  <h1>sign_symmetry</h1>

<div class="doc doc-object doc-module">

<a id="vmcnet.models.sign_symmetry"></a>
    <div class="doc doc-contents first">

      <p>Routines for symmetrizing a function to be sign covariant.</p>



  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h3 id="vmcnet.models.sign_symmetry.ProductsSignCovariance" class="doc doc-heading">
        <code>
ProductsSignCovariance            (<span title="vmcnet.models.core.Module">Module</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Sign covariance from a weighted sum of products of per-particle values.</p>
<p>Only supports two spins at the moment. Given per-spin antiequivariant vectors
a_1, a_2, ..., and b_1, b_2, ..., computes an antisymmetry of
sum_{i,j} (w_{i,j} sum_{k} a_ik b_jk), or multiple such antisymmetries if
features&gt;1. If use_weights=False, then no weights are used, so that effectively
w_{i,j} = 1 for all i,j.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>features</code></td>
        <td><code>int</code></td>
        <td><p>the number of antisymmetric output features to generate. If
use_weights is False, must be equal to 1.</p></td>
      </tr>
      <tr>
        <td><code>kernel_init</code></td>
        <td><code>WeightInitializer</code></td>
        <td><p>initializer for the weights of the dense layer.</p></td>
      </tr>
      <tr>
        <td><code>register_kfac</code></td>
        <td><code>bool</code></td>
        <td><p>whether to register the dense layer with KFAC.
Defaults to True.</p></td>
      </tr>
      <tr>
        <td><code>use_weights</code></td>
        <td><code>bool</code></td>
        <td><p>whether to use a weighted sum of products.
Defaults to False.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">
















  <div class="doc doc-object doc-method">



<h4 id="vmcnet.models.sign_symmetry.ProductsSignCovariance.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h4>

    <div class="doc doc-contents ">

      <p>Calculate weighted sum of products of up- and down-spin antiequivariances.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td><code>ArrayList</code></td>
        <td><p>input antiequivariant arrays of shape
[(..., nelec_up, d), (..., nelec_down, d)]</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Array</code></td>
      <td><p>array of length features of antisymmetric values calculated
    by taking a weighted sum of the pairwise dot-products of the up- and
    down-spin antiequivariant inputs.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>vmcnet/models/sign_symmetry.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@flax</span><span class="o">.</span><span class="n">linen</span><span class="o">.</span><span class="n">compact</span>
<span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">ArrayList</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>  <span class="c1"># type: ignore[override]</span>
    <span class="sd">&quot;&quot;&quot;Calculate weighted sum of products of up- and down-spin antiequivariances.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        x (ArrayList): input antiequivariant arrays of shape</span>
<span class="sd">            [(..., nelec_up, d), (..., nelec_down, d)]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Array: array of length features of antisymmetric values calculated</span>
<span class="sd">            by taking a weighted sum of the pairwise dot-products of the up- and</span>
<span class="sd">            down-spin antiequivariant inputs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO (ggoldsh): update this to support nspins != 2 as well</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Products covariance only supported for nspins=2, got </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="p">)</span>

    <span class="n">naxes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">batch_dims</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">naxes</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">contraction_dim</span> <span class="o">=</span> <span class="p">(</span><span class="n">naxes</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,)</span>
    <span class="c1"># Since the second last axis is not specified as either a batch or contraction</span>
    <span class="c1"># dim, jax.lax.dot_general will automatically compute over all pairs of up and</span>
    <span class="c1"># down spins. pairwise_dots thus has shape (..., nelec_up, nelec_down).</span>
    <span class="n">pairwise_dots</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">dot_general</span><span class="p">(</span>
        <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">((</span><span class="n">contraction_dim</span><span class="p">,</span> <span class="n">contraction_dim</span><span class="p">),</span> <span class="p">(</span><span class="n">batch_dims</span><span class="p">,</span> <span class="n">batch_dims</span><span class="p">))</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_weights</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">features</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Can only return one output feature when use_weights is False. &quot;</span>
                <span class="s2">&quot;Received </span><span class="si">{}</span><span class="s2"> for features.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">features</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pairwise_dots</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">shape</span> <span class="o">=</span> <span class="n">pairwise_dots</span><span class="o">.</span><span class="n">shape</span>
    <span class="c1"># flattened_dots has shape (..., nelec_up * nelec_down)</span>
    <span class="n">flattened_dots</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
        <span class="n">pairwise_dots</span><span class="p">,</span> <span class="p">(</span><span class="o">*</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">Dense</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">features</span><span class="p">,</span>
        <span class="n">kernel_init</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_init</span><span class="p">,</span>
        <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">register_kfac</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">register_kfac</span><span class="p">,</span>
    <span class="p">)(</span><span class="n">flattened_dots</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h3 id="vmcnet.models.sign_symmetry.apply_sign_symmetry_to_fn" class="doc doc-heading">
<code class="highlight language-python"><span class="n">apply_sign_symmetry_to_fn</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">get_signs_and_syms</span><span class="p">,</span> <span class="n">apply_output_signs</span><span class="p">,</span> <span class="n">add_up_results</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Make a function of a list of inputs covariant in the sign of each input.</p>
<p>That is, output a function g(s_1, s_2, ..., s_n) with is odd with respect to each
input, such that g(s_1, ...) = -g(-s_1, ...), and likewise for every other input.</p>
<p>This is done by taking the orbit of the inputs with respect to the sign group
applied separately to each one, and adding up the results with appropriate
covariant signs. For example, for two spins this calculates
g(U,D) = f(U,D) - f(-U,D) - f(U, -D) + f(-U, -D).</p>
<p>Inputs are assumed to be either Arrays or SLArrays, so that in either case the
required symmetries can be stacked along a new axis of the underlying array values.
The function <code>fn</code> is assumed to support the injection of a batch dimension, done in
<code>get_signs_and_syms</code>, and pass it through to the output (e.g., a function which
flattens the input would not be supported). The extra dimension is removed at the
end via <code>add_up_results</code>.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>fn</code></td>
        <td><code>Callable</code></td>
        <td><p>the function to symmetrize. The given axis is injected into the
inputs and the sign orbit is computed, so this function should be able to
treat the given sign orbit axis as a batch dimension, and the overall tensor
rank should not change (len(input.shape) == len(output.shape))</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>get_signs_and_syms</code></td>
        <td><code>Callable</code></td>
        <td><p>a function which gets the signs and symmetries
for the input array. Returns a tuple of the symmetries plus the associated
signs as a 1D array.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>apply_output_signs</code></td>
        <td><code>Callable</code></td>
        <td><p>function for applying signs to the outputs of
the symmetrized function. For example, if the outputs are Arrays, this
would simply multiply the arrays by the signs along the appropriate axis.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>add_up_results</code></td>
        <td><code>Callable</code></td>
        <td><p>function for combining the signed outputs into a
single, sign-covariant output. For example, simple addition for Arrays
or the slog_sum function for SLArrays.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Callable</code></td>
      <td><p>a function with the same signature as the input function, but
which has been symmetrized so that its output will be covariant with respect
to the sign of each input, or in other words, will be odd.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>vmcnet/models/sign_symmetry.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">apply_sign_symmetry_to_fn</span><span class="p">(</span>
    <span class="n">fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">List</span><span class="p">[</span><span class="n">A</span><span class="p">]],</span> <span class="n">A</span><span class="p">],</span>
    <span class="n">get_signs_and_syms</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">List</span><span class="p">[</span><span class="n">A</span><span class="p">]],</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">A</span><span class="p">],</span> <span class="n">Array</span><span class="p">]],</span>
    <span class="n">apply_output_signs</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">A</span><span class="p">,</span> <span class="n">Array</span><span class="p">],</span> <span class="n">A</span><span class="p">],</span>
    <span class="n">add_up_results</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">A</span><span class="p">],</span> <span class="n">A</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">List</span><span class="p">[</span><span class="n">A</span><span class="p">]],</span> <span class="n">A</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Make a function of a list of inputs covariant in the sign of each input.</span>

<span class="sd">    That is, output a function g(s_1, s_2, ..., s_n) with is odd with respect to each</span>
<span class="sd">    input, such that g(s_1, ...) = -g(-s_1, ...), and likewise for every other input.</span>

<span class="sd">    This is done by taking the orbit of the inputs with respect to the sign group</span>
<span class="sd">    applied separately to each one, and adding up the results with appropriate</span>
<span class="sd">    covariant signs. For example, for two spins this calculates</span>
<span class="sd">    g(U,D) = f(U,D) - f(-U,D) - f(U, -D) + f(-U, -D).</span>

<span class="sd">    Inputs are assumed to be either Arrays or SLArrays, so that in either case the</span>
<span class="sd">    required symmetries can be stacked along a new axis of the underlying array values.</span>
<span class="sd">    The function `fn` is assumed to support the injection of a batch dimension, done in</span>
<span class="sd">    `get_signs_and_syms`, and pass it through to the output (e.g., a function which</span>
<span class="sd">    flattens the input would not be supported). The extra dimension is removed at the</span>
<span class="sd">    end via `add_up_results`.</span>

<span class="sd">    Args:</span>
<span class="sd">        fn (Callable): the function to symmetrize. The given axis is injected into the</span>
<span class="sd">            inputs and the sign orbit is computed, so this function should be able to</span>
<span class="sd">            treat the given sign orbit axis as a batch dimension, and the overall tensor</span>
<span class="sd">            rank should not change (len(input.shape) == len(output.shape))</span>
<span class="sd">        get_signs_and_syms (Callable): a function which gets the signs and symmetries</span>
<span class="sd">            for the input array. Returns a tuple of the symmetries plus the associated</span>
<span class="sd">            signs as a 1D array.</span>
<span class="sd">        apply_output_signs (Callable): function for applying signs to the outputs of</span>
<span class="sd">            the symmetrized function. For example, if the outputs are Arrays, this</span>
<span class="sd">            would simply multiply the arrays by the signs along the appropriate axis.</span>
<span class="sd">        add_up_results (Callable): function for combining the signed outputs into a</span>
<span class="sd">            single, sign-covariant output. For example, simple addition for Arrays</span>
<span class="sd">            or the slog_sum function for SLArrays.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Callable: a function with the same signature as the input function, but</span>
<span class="sd">        which has been symmetrized so that its output will be covariant with respect</span>
<span class="sd">        to the sign of each input, or in other words, will be odd.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">sign_covariant_fn</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">A</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">A</span><span class="p">:</span>
        <span class="n">symmetries</span><span class="p">,</span> <span class="n">signs</span> <span class="o">=</span> <span class="n">get_signs_and_syms</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="n">symmetries</span><span class="p">)</span>
        <span class="n">signed_results</span> <span class="o">=</span> <span class="n">apply_output_signs</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">signs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">add_up_results</span><span class="p">(</span><span class="n">signed_results</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sign_covariant_fn</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="vmcnet.models.sign_symmetry.make_sl_array_list_fn_sign_covariant" class="doc doc-heading">
<code class="highlight language-python"><span class="n">make_sl_array_list_fn_sign_covariant</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Make a function of an SLArrayList sign-covariant in the sign of each SLArray.</p>
<p>Shallow wrapper around the generic apply_sign_symmetry_to_fn.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>fn</code></td>
        <td><code>Callable</code></td>
        <td><p>the function to symmetrize. The given axis is injected into the
inputs and the sign orbit is computed, so this function should be able to
treat the given sign orbit axis as a batch dimension, and the overall tensor
rank should not change (len(input.shape) == len(output.shape))</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Callable</code></td>
      <td><p>a function with the same signature as the input function, but
which has been symmetrized so that its output will be covariant with respect
to the sign of each input, or in other words, will be odd.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>vmcnet/models/sign_symmetry.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">make_sl_array_list_fn_sign_covariant</span><span class="p">(</span>
    <span class="n">fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">SLArrayList</span><span class="p">],</span> <span class="n">SLArray</span><span class="p">],</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">SLArrayList</span><span class="p">],</span> <span class="n">SLArray</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Make a function of an SLArrayList sign-covariant in the sign of each SLArray.</span>

<span class="sd">    Shallow wrapper around the generic apply_sign_symmetry_to_fn.</span>

<span class="sd">    Args:</span>
<span class="sd">        fn (Callable): the function to symmetrize. The given axis is injected into the</span>
<span class="sd">            inputs and the sign orbit is computed, so this function should be able to</span>
<span class="sd">            treat the given sign orbit axis as a batch dimension, and the overall tensor</span>
<span class="sd">            rank should not change (len(input.shape) == len(output.shape))</span>

<span class="sd">    Returns:</span>
<span class="sd">        Callable: a function with the same signature as the input function, but</span>
<span class="sd">        which has been symmetrized so that its output will be covariant with respect</span>
<span class="sd">        to the sign of each input, or in other words, will be odd.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">apply_sign_symmetry_to_fn</span><span class="p">(</span>
        <span class="n">fn</span><span class="p">,</span>
        <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">_get_sign_orbit_sl_array_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">),</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="p">(</span><span class="n">_multiply_sign_along_axis</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s</span><span class="p">,</span> <span class="n">axis</span><span class="p">),</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
        <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">slog_sum_over_axis</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="vmcnet.models.sign_symmetry.make_array_list_fn_sign_covariant" class="doc doc-heading">
<code class="highlight language-python"><span class="n">make_array_list_fn_sign_covariant</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Make a function of an ArrayList sign-covariant in the sign of each array.</p>
<p>Shallow wrapper around the generic apply_sign_symmetry_to_fn.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>fn</code></td>
        <td><code>Callable</code></td>
        <td><p>the function to symmetrize. The given axis is injected into the
inputs and the sign orbit is computed, so this function should be able to
treat the given sign orbit axis as a batch dimension, and the overall tensor
rank should not change (len(input.shape) == len(output.shape))</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Callable</code></td>
      <td><p>a function with the same signature as the input function, but
which has been symmetrized so that its output will be covariant with respect
to the sign of each input, or in other words, will be odd.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>vmcnet/models/sign_symmetry.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">make_array_list_fn_sign_covariant</span><span class="p">(</span>
    <span class="n">fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">ArrayList</span><span class="p">],</span> <span class="n">Array</span><span class="p">],</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">ArrayList</span><span class="p">],</span> <span class="n">Array</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Make a function of an ArrayList sign-covariant in the sign of each array.</span>

<span class="sd">    Shallow wrapper around the generic apply_sign_symmetry_to_fn.</span>

<span class="sd">    Args:</span>
<span class="sd">        fn (Callable): the function to symmetrize. The given axis is injected into the</span>
<span class="sd">            inputs and the sign orbit is computed, so this function should be able to</span>
<span class="sd">            treat the given sign orbit axis as a batch dimension, and the overall tensor</span>
<span class="sd">            rank should not change (len(input.shape) == len(output.shape))</span>

<span class="sd">    Returns:</span>
<span class="sd">        Callable: a function with the same signature as the input function, but</span>
<span class="sd">        which has been symmetrized so that its output will be covariant with respect</span>
<span class="sd">        to the sign of each input, or in other words, will be odd.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">apply_sign_symmetry_to_fn</span><span class="p">(</span>
        <span class="n">fn</span><span class="p">,</span>
        <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">_get_sign_orbit_array_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">),</span>
        <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">_multiply_sign_along_axis</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">),</span>
        <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="vmcnet.models.sign_symmetry.make_array_list_fn_sign_invariant" class="doc doc-heading">
<code class="highlight language-python"><span class="n">make_array_list_fn_sign_invariant</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Make a function of an ArrayList sign-invariant (even) in the sign of each array.</p>
<p>Shallow wrapper around the generic apply_sign_symmetry_to_fn.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>fn</code></td>
        <td><code>Callable</code></td>
        <td><p>the function to symmetrize. The given axis is injected into the
inputs and the sign orbit is computed, so this function should be able to
treat the given sign orbit axis as a batch dimension, and the overall tensor
rank should not change (len(input.shape) == len(output.shape))</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Callable</code></td>
      <td><p>a function with the same signature as the input function, but
which has been symmetrized so that its output will be invariant with respect
to the sign of each input, or in other words, will be even.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>vmcnet/models/sign_symmetry.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">make_array_list_fn_sign_invariant</span><span class="p">(</span>
    <span class="n">fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">ArrayList</span><span class="p">],</span> <span class="n">Array</span><span class="p">],</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">ArrayList</span><span class="p">],</span> <span class="n">Array</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Make a function of an ArrayList sign-invariant (even) in the sign of each array.</span>

<span class="sd">    Shallow wrapper around the generic apply_sign_symmetry_to_fn.</span>

<span class="sd">    Args:</span>
<span class="sd">        fn (Callable): the function to symmetrize. The given axis is injected into the</span>
<span class="sd">            inputs and the sign orbit is computed, so this function should be able to</span>
<span class="sd">            treat the given sign orbit axis as a batch dimension, and the overall tensor</span>
<span class="sd">            rank should not change (len(input.shape) == len(output.shape))</span>

<span class="sd">    Returns:</span>
<span class="sd">        Callable: a function with the same signature as the input function, but</span>
<span class="sd">        which has been symmetrized so that its output will be invariant with respect</span>
<span class="sd">        to the sign of each input, or in other words, will be even.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">apply_sign_symmetry_to_fn</span><span class="p">(</span>
        <span class="n">fn</span><span class="p">,</span>
        <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">_get_sign_orbit_array_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">),</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span>  <span class="c1"># Ignore the signs to get an invariance</span>
        <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../jastrow/" class="md-footer__link md-footer__link--prev" aria-label="Previous: jastrow" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              jastrow
            </div>
          </div>
        </a>
      
      
        
        <a href="../weights/" class="md-footer__link md-footer__link--next" aria-label="Next: weights" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              weights
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.tracking"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.cefbb252.min.js", "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.a5f8ea78.min.js"></script>
      
    
  </body>
</html>